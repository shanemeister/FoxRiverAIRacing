2025-03-12 05:00:04 - INFO - Logging has been set up successfully.
2025-03-12 05:00:04 - INFO - Loading gpspoint data from PostgreSQL...
2025-03-12 05:00:05 - INFO - Saving gpspoint DataFrame to Parquet at /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/parquet/gpspoint.parquet...
2025-03-12 05:03:03 - INFO - gpspoint data loaded and saved successfully.
2025-03-12 05:03:03 - INFO - Loading sectionals data from PostgreSQL...
2025-03-12 05:03:03 - INFO - Saving sectionals DataFrame to Parquet at /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/parquet/sectionals.parquet...
2025-03-12 05:03:20 - INFO - sectionals data loaded and saved successfully.
2025-03-12 05:03:20 - INFO - Loading runners data from PostgreSQL...
2025-03-12 05:03:20 - INFO - Saving runners DataFrame to Parquet at /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/parquet/runners.parquet...
2025-03-12 05:03:33 - INFO - runners data loaded and saved successfully.
2025-03-12 05:03:33 - INFO - Loading horse data from PostgreSQL...
2025-03-12 05:03:33 - INFO - Saving horse DataFrame to Parquet at /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/parquet/horse.parquet...
2025-03-12 05:03:33 - INFO - horse data loaded and saved successfully.
2025-03-12 05:03:33 - INFO - DataFrame 'gpspoint' loaded. Schema:
2025-03-12 05:03:33 - INFO - DataFrame 'sectionals' loaded. Schema:
2025-03-12 05:03:33 - INFO - DataFrame 'runners' loaded. Schema:
2025-03-12 05:03:33 - INFO - DataFrame 'horse' loaded. Schema:
2025-03-12 05:03:33 - INFO - Starting Spark-based aggregation for sectionals keyed by (horse_id, as_of_date) with LOCF ...
2025-03-12 05:03:45 - INFO - Writing aggregator keyed by (horse_id, as_of_date) with LOCF to sectionals_aggregated_locf (overwrite).
2025-03-12 05:04:05 - INFO - Done. Wrote table=sectionals_aggregated_locf in 31.65 sec, keyed by (horse_id, as_of_date).
2025-03-12 05:04:05 - INFO - Starting Spark-based aggregation for sectionals...
2025-03-12 05:04:05 - ERROR - Error during Spark initialization: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `course_cd` cannot be resolved. Did you mean one of the following? [`horse_id`, `sex`, `color`, `horse_name`, `axciskey`].;
'Aggregate ['course_cd, 'race_date, 'race_number, 'saddle_cloth_number], ['course_cd, 'race_date, 'race_number, 'saddle_cloth_number, count('gate_numeric) AS num_gates#20797]
+- Relation [axciskey#221,horse_name#222,foal_date#223,sex#224,wh_foaled#225,color#226,horse_id#227] JDBCRelation((
            SELECT *
            FROM horse
        ) AS subquery) [numPartitions=1]

2025-03-12 05:04:05 - INFO - Closing down clientserver connection
