2025-02-22 22:29:08 - INFO - Logging has been set up successfully.
2025-02-22 22:29:08 - INFO - Starting main function...
2025-02-22 22:29:08 - INFO - Mode: predict
2025-02-22 22:29:09 - INFO - Starting build_catboost_model: Training CatBoost Models -- 20 total
2025-02-22 22:29:09 - INFO - Shape of future Pandas DF: (2068, 126)
2025-02-22 22:29:09 - INFO - Found these CatBoost model files:
2025-02-22 22:29:09 - INFO -   catboost_QueryRMSE_NDCG:top=1_20250222_153258.cbm
2025-02-22 22:29:09 - INFO -   catboost_QueryRMSE_NDCG:top=2_20250222_154658.cbm
2025-02-22 22:29:09 - INFO -   catboost_QueryRMSE_NDCG:top=3_20250222_160009.cbm
2025-02-22 22:29:09 - INFO -   catboost_QueryRMSE_NDCG:top=4_20250222_161304.cbm
2025-02-22 22:29:09 - INFO -   catboost_YetiRank:top=3_NDCG:top=1_20250222_181636.cbm
2025-02-22 22:29:09 - INFO -   catboost_YetiRank:top=3_NDCG:top=3_20250222_184653.cbm
2025-02-22 22:29:09 - INFO -   catboost_YetiRank:top=4_NDCG:top=4_20250222_200441.cbm
2025-02-22 22:29:09 - INFO - Making predictions with model: catboost_QueryRMSE_NDCG:top=1_20250222_153258.cbm
2025-02-22 22:29:09 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric']
2025-02-22 22:29:09 - INFO - Inference DF dtypes:
2025-02-22 22:29:09 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:09 - INFO - Null counts:
2025-02-22 22:29:09 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:09 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:09 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_QueryRMSE_NDCG:top=1_20250222_153258.cbm
2025-02-22 22:29:09 - INFO - Making predictions with model: catboost_QueryRMSE_NDCG:top=2_20250222_154658.cbm
2025-02-22 22:29:09 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric', 'QueryRMSE_NDCG_top_1']
2025-02-22 22:29:09 - INFO - Inference DF dtypes:
2025-02-22 22:29:09 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:09 - INFO - Null counts:
2025-02-22 22:29:09 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:09 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:09 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_QueryRMSE_NDCG:top=2_20250222_154658.cbm
2025-02-22 22:29:09 - INFO - Making predictions with model: catboost_QueryRMSE_NDCG:top=3_20250222_160009.cbm
2025-02-22 22:29:09 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric', 'QueryRMSE_NDCG_top_1', 'QueryRMSE_NDCG_top_2']
2025-02-22 22:29:09 - INFO - Inference DF dtypes:
2025-02-22 22:29:09 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:09 - INFO - Null counts:
2025-02-22 22:29:09 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:09 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:09 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_QueryRMSE_NDCG:top=3_20250222_160009.cbm
2025-02-22 22:29:09 - INFO - Making predictions with model: catboost_QueryRMSE_NDCG:top=4_20250222_161304.cbm
2025-02-22 22:29:09 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric', 'QueryRMSE_NDCG_top_1', 'QueryRMSE_NDCG_top_2', 'QueryRMSE_NDCG_top_3']
2025-02-22 22:29:09 - INFO - Inference DF dtypes:
2025-02-22 22:29:09 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:09 - INFO - Null counts:
2025-02-22 22:29:09 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:09 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:09 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_QueryRMSE_NDCG:top=4_20250222_161304.cbm
2025-02-22 22:29:09 - INFO - Making predictions with model: catboost_YetiRank:top=3_NDCG:top=1_20250222_181636.cbm
2025-02-22 22:29:09 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric', 'QueryRMSE_NDCG_top_1', 'QueryRMSE_NDCG_top_2', 'QueryRMSE_NDCG_top_3', 'QueryRMSE_NDCG_top_4']
2025-02-22 22:29:09 - INFO - Inference DF dtypes:
2025-02-22 22:29:09 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:09 - INFO - Null counts:
2025-02-22 22:29:09 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:09 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:09 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_YetiRank:top=3_NDCG:top=1_20250222_181636.cbm
2025-02-22 22:29:09 - INFO - Making predictions with model: catboost_YetiRank:top=3_NDCG:top=3_20250222_184653.cbm
2025-02-22 22:29:09 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric', 'QueryRMSE_NDCG_top_1', 'QueryRMSE_NDCG_top_2', 'QueryRMSE_NDCG_top_3', 'QueryRMSE_NDCG_top_4', 'YetiRank_top_3_NDCG_top_1']
2025-02-22 22:29:09 - INFO - Inference DF dtypes:
2025-02-22 22:29:09 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:09 - INFO - Null counts:
2025-02-22 22:29:09 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:09 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:09 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_YetiRank:top=3_NDCG:top=3_20250222_184653.cbm
2025-02-22 22:29:10 - INFO - Making predictions with model: catboost_YetiRank:top=4_NDCG:top=4_20250222_200441.cbm
2025-02-22 22:29:10 - INFO - inference_df columns before reindexing: ['course_cd', 'race_date', 'race_number', 'horse_id', 'axciskey', 'saddle_cloth_number', 'horse_name', 'time_behind', 'pace_delta_time', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'speed_rating', 'prev_speed_rating', 'previous_class', 'purse', 'weight', 'date_of_birth', 'sex', 'equip', 'claimprice', 'surface', 'distance_meters', 'class_rating', 'previous_distance', 'previous_surface', 'off_finish_last_race', 'power', 'trk_cond', 'med', 'morn_odds', 'avgspd', 'starts', 'race_type', 'net_sentiment', 'stk_clm_md', 'turf_mud_mark', 'avg_spd_sd', 'ave_cl_sd', 'hi_spd_sd', 'pstyerl', 'all_starts', 'all_win', 'all_place', 'all_show', 'all_fourth', 'all_earnings', 'horse_itm_percentage', 'cond_starts', 'cond_win', 'cond_place', 'cond_show', 'cond_fourth', 'cond_earnings', 'jock_win_percent', 'jock_itm_percent', 'trainer_win_percent', 'trainer_itm_percent', 'jt_win_percent', 'jt_itm_percent', 'jock_win_track', 'jock_itm_track', 'trainer_win_track', 'trainer_itm_track', 'jt_win_track', 'jt_itm_track', 'sire_itm_percentage', 'sire_roi', 'dam_itm_percentage', 'dam_roi', 'total_races_5', 'avg_fin_5', 'avg_speed_5', 'best_speed', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_speed_fullrace_5', 'avg_stride_length_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'prev_speed', 'speed_improvement', 'days_off', 'layoff_cat', 'avg_workout_rank_3', 'count_workouts_3', 'race_count', 'track_name', 'has_gps', 'data_flag', 'missing_gps_flag', 'gps_present', 'age_at_race_day', 'race_missing_flag', 'class_multiplier', 'class_offset', 'official_distance', 'base_speed', 'wide_factor', 'par_time', 'par_diff_ratio', 'raw_performance_score', 'normalized_score', 'global_speed_score', 'group_id', 'recent_avg_speed', 'combined_0', 'combined_1', 'combined_2', 'combined_3', 'combined_4', 'combined_4_most_recent', 'race_id', 'first_race_date_5_numeric', 'most_recent_race_5_numeric', 'prev_race_date_numeric', 'QueryRMSE_NDCG_top_1', 'QueryRMSE_NDCG_top_2', 'QueryRMSE_NDCG_top_3', 'QueryRMSE_NDCG_top_4', 'YetiRank_top_3_NDCG_top_1', 'YetiRank_top_3_NDCG_top_3']
2025-02-22 22:29:10 - INFO - Inference DF dtypes:
2025-02-22 22:29:10 - INFO - avgspd                    float64
prev_race_date_numeric      int64
avg_dist_bk_gate1_5       float64
dist_penalty              float64
gps_present                 int64
                           ...   
running_time              float64
dist_bk_gate4             float64
total_distance_ran        float64
pace_delta_time           float64
time_behind               float64
Length: 100, dtype: object
2025-02-22 22:29:10 - INFO - Null counts:
2025-02-22 22:29:10 - INFO - avgspd                       0
prev_race_date_numeric       0
avg_dist_bk_gate1_5          0
dist_penalty              2068
gps_present                  0
                          ... 
running_time                 0
dist_bk_gate4                0
total_distance_ran           0
pace_delta_time              0
time_behind                  0
Length: 100, dtype: int64
2025-02-22 22:29:10 - INFO - inference_df columns after reindexing: ['avgspd', 'prev_race_date_numeric', 'avg_dist_bk_gate1_5', 'dist_penalty', 'gps_present', 'trainer_itm_track', 'net_sentiment', 'percentile_score', 'dam_roi', 'distance_meters', 'jt_itm_percent', 'sire_roi', 'combined_3', 'morn_odds', 'avg_speed_5', 'avg_workout_rank_3', 'jock_win_percent', 'trainer_win_percent', 'avg_strfreq_q1_5', 'cond_show', 'avg_dist_bk_gate4_5', 'standardized_score', 'all_starts', 'raw_performance_score', 'weight', 'jock_win_track', 'avg_dist_bk_gate2_5', 'jock_itm_track', 'count_workouts_3', 'par_time', 'sire_itm_percentage', 'cond_starts', 'normalized_score', 'speed_improvement', 'ave_cl_sd', 'all_earnings', 'best_speed', 'official_distance', 'jt_win_percent', 'all_show', 'cond_fourth', 'base_speed', 'hi_spd_sd', 'has_gps', 'avg_beaten_len_5', 'wide_factor', 'avg_dist_bk_gate3_5', 'total_races_5', 'days_off', 'class_multiplier', 'all_fourth', 'starts', 'age_at_race_day', 'trainer_itm_percent', 'class_rating_numeric', 'cond_win', 'avg_speed_fullrace_5', 'purse', 'all_win', 'as_of_date', 'avg_spd_sd', 'combined_0', 'trainer_win_track', 'avg_fin_5', 'prev_speed_rating', 'combined_2', 'avg_stride_length_5', 'avg_strfreq_q2_5', 'jt_win_track', 'class_offset', 'horse_itm_percentage', 'jt_itm_track', 'speed_rating', 'jock_itm_percent', 'avg_strfreq_q3_5', 'pstyerl', 'all_place', 'combined_1', 'avg_strfreq_q4_5', 'power', 'previous_class', 'race_count', 'prev_speed', 'claimprice', 'first_race_date_5_numeric', 'off_finish_last_race', 'cond_place', 'most_recent_race_5_numeric', 'previous_distance', 'par_diff_ratio', 'class_rating', 'recent_avg_speed', 'combined_4', 'dam_itm_percentage', 'cond_earnings', 'running_time', 'dist_bk_gate4', 'total_distance_ran', 'pace_delta_time', 'time_behind']
2025-02-22 22:29:10 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_YetiRank:top=4_NDCG:top=4_20250222_200441.cbm
2025-02-22 22:29:11 - INFO - Writing predictions to DB table: predictions_2025_02_22_1
2025-02-22 22:29:14 - INFO - Appended 2068 predictions to DB table 'predictions_2025_02_22_1'.
2025-02-22 22:29:14 - INFO - Inference complete.
2025-02-22 22:29:14 - INFO - Training 20 Catboost models Horse embedding took 5.46399188041687 to complete.
2025-02-22 22:29:15 - INFO - Spark session stopped.
2025-02-22 22:29:15 - INFO - Closing down clientserver connection
