2025-04-08 21:17:16 - INFO - Logging has been set up successfully.
2025-04-08 21:17:16 - INFO - Starting main function...
2025-04-08 21:17:16 - INFO - Mode: train
2025-04-08 21:17:16 - INFO - Running training data ingestion steps...
2025-04-08 21:17:16 - INFO - Running training data ingestion steps...
2025-04-08 21:17:16 - INFO - Query training_data located and loading from PostgreSQL...
2025-04-08 21:17:17 - INFO - Data loaded from PostgreSQL in 1.23 seconds.
2025-04-08 21:18:19 - INFO - Data loaded from PostgreSQL. Count: 375979
2025-04-08 21:18:19 - INFO - Before filtering on has_gps and course_cd list: data_flag='future': 969
2025-04-08 21:18:19 - INFO - Before filtering on has_gps and course_cd list: data_flag='historical': 375010
2025-04-08 21:18:19 - INFO - After filtering: Number of rows with data_flag='future': 969
2025-04-08 21:18:19 - INFO - After filtering: Number of rows with data_flag='historical': 375010
2025-04-08 21:18:19 - INFO - Row count: 375979
2025-04-08 21:18:19 - INFO - Count operation completed in 63.65 seconds.
2025-04-08 21:18:19 - INFO - Checking for duplicates on primary keys...
2025-04-08 21:18:24 - INFO - Number of duplicate records found: 0
2025-04-08 21:18:24 - INFO - No duplicate records found.
2025-04-08 21:18:24 - INFO - Convert Decimal Columns to Double.
2025-04-08 21:18:25 - INFO - Decimal columns converted to double.
2025-04-08 21:18:27 - INFO - 3. After processing impute_data_of_birth_with_median function: Number of rows with data_flag='future': 969
2025-04-08 21:18:27 - INFO - 3. After processing impute_data_of_birth_with_median function:  Number of rows with data_flag='historical': 375010
2025-04-08 21:18:27 - INFO - Imputing date_of_birth with median date.
2025-04-08 21:18:27 - INFO - Created age_at_race_day.
2025-04-08 21:18:27 - INFO - Imputing categorical and numeric columns.
2025-04-08 21:18:28 - INFO - manage_tpd_cols_by_flag [historical]: before=375010, after=278522
2025-04-08 21:18:29 - INFO - manage_tpd_cols_by_flag [future]: before=969, after=969
2025-04-08 21:18:29 - INFO - Filling missing values for columns.
2025-04-08 21:18:34 - INFO - Numeric columns cast to double.
2025-04-08 21:18:51 - INFO - 5. Just before impute_performance_columns: Number of rows with data_flag='future': 969
2025-04-08 21:18:51 - INFO - 5. Just before impute_performance_columns:  Number of rows with data_flag='historical': 278522
2025-04-08 21:19:26 - INFO - [remove_performance_columns] final future rows = 969, historical rows = 278522
2025-04-08 21:19:26 - INFO - Future rows matched with historical horse_id: 694
2025-04-08 21:19:26 - INFO - Future rows unmatched with historical horse_id: 275
2025-04-08 21:19:26 - INFO - Number of future races with >=1 unmatched horse: 68
2025-04-08 21:19:26 - INFO - Number of future races with NO unmatched horse: 33
2025-04-08 21:19:30 - INFO - 5. Just after impute_performance_columns: Number of rows with data_flag='future': 969
2025-04-08 21:19:30 - INFO - 5. Just after impute_performance_columns:  Number of rows with data_flag='historical': 278522
2025-04-08 21:19:52 - INFO - 6. Just AFTER deleting columns with NaN/null: Number of rows with data_flag='future': 969
2025-04-08 21:19:52 - INFO - 6. Just AFTER deleting columns with NaN/null: Number of rows with data_flag='historical': 272817
2025-04-08 21:19:52 - INFO - Rows in data_flag: train_df['data_flag'] = 'future'
2025-04-08 21:19:52 - INFO - Starting the write to parquet.
2025-04-08 21:20:06 - INFO - Data written to Parquet in 13.62 seconds
2025-04-08 21:20:06 - INFO - Data cleansing complete. train_df being returned.
2025-04-08 21:20:26 - INFO - Ingestion job for training data succeeded
2025-04-08 21:20:26 - INFO - Loading train_df took 189.92059326171875 to complete.
2025-04-08 21:21:52 - INFO - Spark session stopped.
2025-04-08 21:21:52 - INFO - Closing down clientserver connection
