2025-02-03 00:13:43 - INFO - Logging has been set up successfully.
2025-02-03 00:13:43 - INFO - Starting main function...
2025-02-03 00:13:43 - INFO - Mode: predict
2025-02-03 00:13:45 - INFO - Schema of horse_embedding_df: StructType([StructField('axciskey', StringType(), True), StructField('course_cd', StringType(), True), StructField('race_date', DateType(), True), StructField('race_number', DoubleType(), True), StructField('saddle_cloth_number', StringType(), True), StructField('horse_id', DoubleType(), True), StructField('horse_name', StringType(), True), StructField('official_fin', LongType(), True), StructField('time_behind', DoubleType(), True), StructField('pace_delta_time', DoubleType(), True), StructField('speed_rating', LongType(), True), StructField('prev_speed_rating', DoubleType(), True), StructField('previous_class', DoubleType(), True), StructField('purse', DoubleType(), True), StructField('weight', DoubleType(), True), StructField('sex', StringType(), True), StructField('equip', StringType(), True), StructField('claimprice', DoubleType(), True), StructField('surface', StringType(), True), StructField('distance_meters', DoubleType(), True), StructField('class_rating', DoubleType(), True), StructField('previous_distance', DoubleType(), True), StructField('previous_surface', StringType(), True), StructField('off_finish_last_race', LongType(), True), StructField('power', DoubleType(), True), StructField('trk_cond', StringType(), True), StructField('med', StringType(), True), StructField('morn_odds', DoubleType(), True), StructField('avgspd', DoubleType(), True), StructField('starts', LongType(), True), StructField('race_type', StringType(), True), StructField('net_sentiment', DoubleType(), True), StructField('stk_clm_md', StringType(), True), StructField('turf_mud_mark', StringType(), True), StructField('avg_spd_sd', DoubleType(), True), StructField('ave_cl_sd', DoubleType(), True), StructField('hi_spd_sd', DoubleType(), True), StructField('pstyerl', DoubleType(), True), StructField('all_starts', DoubleType(), True), StructField('all_win', DoubleType(), True), StructField('all_place', DoubleType(), True), StructField('all_show', DoubleType(), True), StructField('all_fourth', DoubleType(), True), StructField('all_earnings', DoubleType(), True), StructField('horse_itm_percentage', DoubleType(), True), StructField('cond_starts', DoubleType(), True), StructField('cond_win', DoubleType(), True), StructField('cond_place', DoubleType(), True), StructField('cond_show', DoubleType(), True), StructField('cond_fourth', DoubleType(), True), StructField('cond_earnings', DoubleType(), True), StructField('jock_win_percent', DoubleType(), True), StructField('jock_itm_percent', DoubleType(), True), StructField('trainer_win_percent', DoubleType(), True), StructField('trainer_itm_percent', DoubleType(), True), StructField('jt_win_percent', DoubleType(), True), StructField('jt_itm_percent', DoubleType(), True), StructField('jock_win_track', DoubleType(), True), StructField('jock_itm_track', DoubleType(), True), StructField('trainer_win_track', DoubleType(), True), StructField('trainer_itm_track', DoubleType(), True), StructField('jt_win_track', DoubleType(), True), StructField('jt_itm_track', DoubleType(), True), StructField('sire_itm_percentage', DoubleType(), True), StructField('sire_roi', DoubleType(), True), StructField('dam_itm_percentage', DoubleType(), True), StructField('dam_roi', DoubleType(), True), StructField('total_races_5', DoubleType(), True), StructField('avg_fin_5', DoubleType(), True), StructField('avg_speed_5', DoubleType(), True), StructField('best_speed', DoubleType(), True), StructField('avg_beaten_len_5', DoubleType(), True), StructField('first_race_date_5', DateType(), True), StructField('most_recent_race_5', DateType(), True), StructField('avg_dist_bk_gate1_5', DoubleType(), True), StructField('avg_dist_bk_gate2_5', DoubleType(), True), StructField('avg_dist_bk_gate3_5', DoubleType(), True), StructField('avg_dist_bk_gate4_5', DoubleType(), True), StructField('avg_speed_fullrace_5', DoubleType(), True), StructField('avg_stride_length_5', DoubleType(), True), StructField('avg_strfreq_q1_5', DoubleType(), True), StructField('avg_strfreq_q2_5', DoubleType(), True), StructField('avg_strfreq_q3_5', DoubleType(), True), StructField('avg_strfreq_q4_5', DoubleType(), True), StructField('prev_speed', DoubleType(), True), StructField('speed_improvement', DoubleType(), True), StructField('prev_race_date', DateType(), True), StructField('days_off', DoubleType(), True), StructField('layoff_cat', StringType(), True), StructField('avg_workout_rank_3', DoubleType(), True), StructField('count_workouts_3', DoubleType(), True), StructField('race_count', DoubleType(), True), StructField('track_name', StringType(), True), StructField('has_gps', LongType(), True), StructField('data_flag', StringType(), True), StructField('age_at_race_day', DoubleType(), True), StructField('gps_present', LongType(), True), StructField('race_id', StringType(), True), StructField('group_id', LongType(), True), StructField('perf_target', LongType(), True), StructField('custom_speed_figure', DoubleType(), True), StructField('horse_idx_x', LongType(), True), StructField('horse_idx_y', LongType(), True), StructField('embed_0', DoubleType(), True), StructField('embed_1', DoubleType(), True), StructField('embed_2', DoubleType(), True), StructField('embed_3', DoubleType(), True)])
2025-02-03 00:13:46 - INFO - Horse_embedding total count: 328753
2025-02-03 00:13:46 - INFO - Row count (historical): 328184
2025-02-03 00:13:46 - INFO - Row count (future): 569
2025-02-03 00:13:47 - INFO - Shape of future Pandas DF: (569, 105)
2025-02-03 00:13:47 - INFO - Future races PDF shape: (569, 105)
2025-02-03 00:13:47 - INFO - Final feature columns: ['age_at_race_day', 'all_earnings', 'all_fourth', 'all_place', 'all_show', 'all_starts', 'all_win', 'ave_cl_sd', 'avg_beaten_len_5', 'avg_dist_bk_gate1_5', 'avg_dist_bk_gate2_5', 'avg_dist_bk_gate3_5', 'avg_dist_bk_gate4_5', 'avg_fin_5', 'avg_spd_sd', 'avg_speed_5', 'avg_speed_fullrace_5', 'avg_strfreq_q1_5', 'avg_strfreq_q2_5', 'avg_strfreq_q3_5', 'avg_strfreq_q4_5', 'avg_stride_length_5', 'avg_workout_rank_3', 'avgspd', 'best_speed', 'claimprice', 'class_rating', 'cond_earnings', 'cond_fourth', 'cond_place', 'cond_show', 'cond_starts', 'cond_win', 'count_workouts_3', 'course_cd', 'custom_speed_figure', 'dam_itm_percentage', 'dam_roi', 'days_off', 'distance_meters', 'embed_0', 'embed_1', 'embed_2', 'embed_3', 'equip', 'first_race_date_5_numeric', 'gps_present', 'group_id', 'has_gps', 'hi_spd_sd', 'horse_itm_percentage', 'jock_itm_percent', 'jock_itm_track', 'jock_win_percent', 'jock_win_track', 'jt_itm_percent', 'jt_itm_track', 'jt_win_percent', 'jt_win_track', 'layoff_cat', 'med', 'morn_odds', 'most_recent_race_5_numeric', 'net_sentiment', 'off_finish_last_race', 'pace_delta_time', 'power', 'prev_race_date_numeric', 'prev_speed', 'prev_speed_rating', 'previous_class', 'previous_distance', 'previous_surface', 'pstyerl', 'purse', 'race_count', 'race_type', 'sex', 'sire_itm_percentage', 'sire_roi', 'speed_improvement', 'speed_rating', 'starts', 'stk_clm_md', 'surface', 'time_behind', 'total_races_5', 'trainer_itm_percent', 'trainer_itm_track', 'trainer_win_percent', 'trainer_win_track', 'trk_cond', 'turf_mud_mark', 'weight']
2025-02-03 00:13:47 - INFO - Number of columns (start): 105
2025-02-03 00:13:47 - INFO - Row count (start): 569
2025-02-03 00:13:47 - INFO - Found these CatBoost model files:
2025-02-03 00:13:47 - INFO -   catboost_YetiRank:top=2_NDCG:top=2_20250202_214740.cbm
2025-02-03 00:13:47 - INFO -   catboost_YetiRank:top=3_NDCG:top=4_20250202_224228.cbm
2025-02-03 00:13:47 - INFO - Making predictions with model: catboost_YetiRank:top=2_NDCG:top=2_20250202_214740.cbm
2025-02-03 00:13:47 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_YetiRank:top=2_NDCG:top=2_20250202_214740.cbm
2025-02-03 00:13:47 - INFO - Making predictions with model: catboost_YetiRank:top=3_NDCG:top=4_20250202_224228.cbm
2025-02-03 00:13:47 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_YetiRank:top=3_NDCG:top=4_20250202_224228.cbm
2025-02-03 00:13:47 - INFO - Writing predictions to DB table: predictions_2025_02_03_1
2025-02-03 00:13:48 - INFO - Appended 569 predictions to DB table 'predictions_2025_02_03_1'.
2025-02-03 00:13:48 - INFO - Inference complete.
2025-02-03 00:13:49 - INFO - Spark session stopped.
2025-02-03 00:13:49 - INFO - Closing down clientserver connection
