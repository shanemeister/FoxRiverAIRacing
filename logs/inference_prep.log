2025-03-06 12:59:30 - INFO - Logging has been set up successfully.
2025-03-06 12:59:30 - INFO - Starting main function...
2025-03-06 12:59:30 - INFO - Mode: load
2025-03-06 12:59:44 - INFO - Rows with valid relevance: 422561
2025-03-06 12:59:44 - INFO - Correlation (global_speed_score_iq vs relevance): 0.5326
2025-03-06 12:59:44 - INFO - RMSE (global_speed_score_iq vs relevance): 99.8415
2025-03-06 12:59:47 - INFO - No duplicates found based on composite key (race_group_col, horse_id, class_col).
2025-03-06 12:59:47 - INFO - Original record count: 424613, enriched record count: 424613
2025-03-06 12:59:47 - INFO - Row counts match after joining aggregated data.
2025-03-06 12:59:47 - INFO - Top 5 horses by global_speed_score_iq:
2025-03-06 12:59:56 - INFO - Horse 29724.0 / FinPos=9 => Speed=135.73328992237228
2025-03-06 12:59:56 - INFO - Horse 91974.0 / FinPos=2 => Speed=134.58226784115692
2025-03-06 12:59:56 - INFO - Horse 5371.0 / FinPos=1 => Speed=134.34414771149983
2025-03-06 12:59:56 - INFO - Horse 41321.0 / FinPos=6 => Speed=134.04203402802744
2025-03-06 12:59:56 - INFO - Horse 27857.0 / FinPos=2 => Speed=133.86327913621025
2025-03-06 12:59:56 - INFO - Bottom 5 horses by global_speed_score_iq:
2025-03-06 13:00:03 - INFO - Horse 12980.0 / FinPos=5 => Speed=61.82035918825724
2025-03-06 13:00:03 - INFO - Horse 15782.0 / FinPos=9 => Speed=62.55218955475221
2025-03-06 13:00:03 - INFO - Horse 37003.0 / FinPos=8 => Speed=63.62163082023441
2025-03-06 13:00:03 - INFO - Horse 207.0 / FinPos=5 => Speed=64.42479309176906
2025-03-06 13:00:03 - INFO - Horse 29099.0 / FinPos=2 => Speed=64.85391121958942
2025-03-06 13:00:03 - INFO - Evaluation & report generation completed in 26.48 seconds.
2025-03-06 13:00:11 - INFO - Original record count: 424613, enriched record count: 424613
2025-03-06 13:00:14 - INFO - No duplicates found based on group_id and horse_id.
2025-03-06 13:00:14 - INFO - Aggregation and join completed in 11.35 seconds.
2025-03-06 13:00:19 - INFO - [remove_performance_columns] final future=2052, historical=422561
2025-03-06 13:00:58 - INFO - Final DF total count: 424613
2025-03-06 13:00:58 - INFO - Final DF count for historical: 422561
2025-03-06 13:00:58 - INFO - Final DF count for future: 2052
2025-03-06 13:01:32 - INFO - Global_speed_score job completed successfully.
2025-03-06 13:01:32 - INFO - Saving global_speed_score DataFrame to Parquet at /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/parquet/global_speed_score.parquet...
2025-03-06 13:01:32 - INFO - Schema of global_speed_score DataFrame:
2025-03-06 13:01:35 - INFO - global_speed_score DataFrame saved successfully.
2025-03-06 13:01:35 - INFO - Ingestion job succeeded and Speed Figure Catboost model complete
2025-03-06 13:01:35 - INFO - global_speed_score saved as parquet file.
2025-03-06 13:01:35 - INFO - Creating global_speed_score took 125.05194091796875 to complete.
2025-03-06 13:02:01 - INFO - Spark session stopped.
2025-03-06 13:02:01 - INFO - Closing down clientserver connection
