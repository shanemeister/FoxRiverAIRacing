2025-05-10 10:42:38 - INFO - Logging has been set up successfully.
2025-05-10 10:42:38 - INFO - Starting main function...
2025-05-10 10:42:38 - INFO - Running training data ingestion steps...
2025-05-10 10:42:38 - INFO - Running training data ingestion steps...
2025-05-10 10:42:38 - INFO - Query training_data located and loading from PostgreSQL...
2025-05-10 10:42:40 - INFO - Data loaded from PostgreSQL in 1.23 seconds.
2025-05-10 10:42:43 - INFO - Before filtering on has_gps and course_cd list: Predictions: 349818
2025-05-10 10:42:46 - INFO - Row count: 349818
2025-05-10 10:42:46 - INFO - Count operation completed in 7.32 seconds.
2025-05-10 10:42:46 - INFO - Checking for duplicates on primary keys...
2025-05-10 10:42:58 - INFO - Number of duplicate records found: 0
2025-05-10 10:42:58 - INFO - No duplicate records found.
2025-05-10 10:42:58 - INFO - Convert Decimal Columns to Double.
2025-05-10 10:43:00 - INFO - Decimal columns converted to double.
2025-05-10 10:43:04 - INFO - Imputing date_of_birth with median date.
2025-05-10 10:43:04 - INFO - Created age_at_race_day.
2025-05-10 10:43:04 - INFO - Imputing categorical and numeric columns.
2025-05-10 10:44:12 - INFO - manage_tpd_cols_by_flag before=349818, after=349818
2025-05-10 10:44:12 - INFO - Filling missing values for columns.
2025-05-10 10:44:20 - INFO - Numeric columns cast to double.
2025-05-10 10:44:58 - INFO - 5. Just before impute_performance_columns: Prediction_count: 349818
2025-05-10 10:46:29 - INFO - Data written to Parquet in 64.61 seconds
2025-05-10 10:46:29 - INFO - Data cleansing complete. prediction_df being returned.
2025-05-10 10:47:33 - INFO - Ingestion job for prediction data succeeded
2025-05-10 10:47:33 - INFO - Loading prediction_df took 294.30919432640076 to complete.
2025-05-10 10:49:29 - INFO - === Starting Multi-Model Future Inference ===
2025-05-10 10:49:29 - INFO - Found these CatBoost model files:
2025-05-10 10:49:29 - INFO -   catboost_YetiRank_NDCG:top=3_20250506_112234.cbm
2025-05-10 10:49:29 - INFO - === Making predictions with model: catboost_YetiRank_NDCG:top=3_20250506_112234.cbm ===
2025-05-10 10:49:30 - INFO - Loaded CatBoost model: /home/exx/myCode/horse-racing/FoxRiverAIRacing/data/models/catboost/catboost_YetiRank_NDCG:top=3_20250506_112234.cbm
2025-05-10 10:49:30 - INFO - Writing predictions to DB table: predictions_20250510_104930_1
2025-05-10 10:52:02 - INFO - Wrote 349818 predictions to DB table 'predictions_20250510_104930_1'.
2025-05-10 10:52:02 - INFO - === Finished Multi-Model Future Inference ===
2025-05-10 10:52:03 - INFO - Spark session stopped.
2025-05-10 10:52:03 - INFO - Closing down clientserver connection
